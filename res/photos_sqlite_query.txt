SELECT 
#MAIN_ASSET_TABLE#.ZFILENAME AS Filename, 
ZADDITIONALASSETATTRIBUTES.ZORIGINALFILENAME AS Original_Filename,
#MAIN_ASSET_TABLE#.ZDIRECTORY AS Directory,
CASE #MAIN_ASSET_TABLE#.ZKIND WHEN 1 THEN 'Video' WHEN 0 THEN 'Image' END AS FileType,
HEX(ZADDITIONALASSETATTRIBUTES.ZORIGINALHASH) AS Original_Hash,
ZADDITIONALASSETATTRIBUTES.ZORIGINALFILESIZE AS FileSize,
ROUND((CAST(ZADDITIONALASSETATTRIBUTES.ZORIGINALFILESIZE AS REAL) / (1024*1024)),2) || 'MB' AS FileSize_MB,
ZADDITIONALASSETATTRIBUTES.ZORIGINALWIDTH AS Width,
ZADDITIONALASSETATTRIBUTES.ZORIGINALHEIGHT AS Height,
ZADDITIONALASSETATTRIBUTES.ZCREATORBUNDLEID AS Application_Package,
CASE ZADDITIONALASSETATTRIBUTES.ZIMPORTEDBY WHEN 1 THEN 'Back Camera' WHEN 2 THEN 'Front Camera' WHEN 3 THEN '3rd Party Package/App' WHEN 6 THEN '3rd Party Package/App' WHEN 8 THEN 'System Package/App' WHEN 9 THEN 'Native Package/App' ELSE ZADDITIONALASSETATTRIBUTES.ZIMPORTEDBY END AS Imported_Via,
ZGENERICALBUM.ZTITLE AS Album_Title,

CASE #MAIN_ASSET_TABLE#.ZORIENTATION WHEN 1 THEN 'Horizontal (Left)' WHEN 3 THEN 'Horizontal (Right)' WHEN 6 THEN 'Vertical (Up)' WHEN 8 THEN 'Vertical (Down)' END AS Orientation,
#MAIN_ASSET_TABLE#.ZDURATION AS Duration, 
datetime('2001-01-01', #MAIN_ASSET_TABLE#.ZDATECREATED || ' seconds') AS Created_Date,
datetime('2001-01-01', #MAIN_ASSET_TABLE#.ZMODIFICATIONDATE || ' seconds') AS Modified_Date,
ZADDITIONALASSETATTRIBUTES.ZEXIFTIMESTAMPSTRING AS EXIF_Timestamp,
datetime('2001-01-01', #MAIN_ASSET_TABLE#.ZADDEDDATE || ' seconds') AS Added_Date,
CASE #MAIN_ASSET_TABLE#.ZLATITUDE WHEN '-180.0' THEN '-' ELSE #MAIN_ASSET_TABLE#.ZLATITUDE END AS Latitude,
CASE #MAIN_ASSET_TABLE#.ZLONGITUDE WHEN '-180.0' THEN '-' ELSE #MAIN_ASSET_TABLE#.ZLONGITUDE END AS Longitude,
ZADDITIONALASSETATTRIBUTES.ZTIMEZONENAME AS Timezone,
quote(ZADDITIONALASSETATTRIBUTES.ZREVERSELOCATIONDATA) AS Location_Lookup,
CASE ZADDITIONALASSETATTRIBUTES.ZREVERSELOCATIONDATAISVALID WHEN 1 THEN 'Valid' ELSE 'Invalid' END AS Location_Lookup_Validity,

CASE #MAIN_ASSET_TABLE#.ZHASADJUSTMENTS WHEN 0 THEN 'No' WHEN 1 THEN 'Yes' ELSE ZHASADJUSTMENTS END AS Adjusted,
ZADDITIONALASSETATTRIBUTES.ZEDITORBUNDLEID AS Adjustment_Package,
datetime('2001-01-01', ZUNMANAGEDADJUSTMENT.ZADJUSTMENTTIMESTAMP || ' seconds') AS Adjusted_Timestamp,
ZUNMANAGEDADJUSTMENT.ZADJUSTMENTFORMATIDENTIFIER AS Adjustment_Format_ID,
ZUNMANAGEDADJUSTMENT.ZEDITORLOCALIZEDNAME AS Adjustment_Format_Name,

CASE #MAIN_ASSET_TABLE#.ZHIDDEN WHEN 0 THEN 'No' ELSE 'Yes' END AS Hidden,
CASE #MAIN_ASSET_TABLE#.ZTRASHEDSTATE WHEN 1 THEN 'Deleted' ELSE 'Not Deleted' END AS Trashed_State,
datetime('2001-01-01', #MAIN_ASSET_TABLE#.ZTRASHEDDATE || ' seconds') AS Trashed_Date,
#MAIN_ASSET_TABLE#.ZTHUMBNAILINDEX AS Thumbnail_Index,
CASE #MAIN_ASSET_TABLE#.ZPLAYBACKSTYLE WHEN 1 THEN 'Static Image' WHEN 3 THEN 'Live Image (embedded frames)' WHEN 4 THEN 'Video Frames' ELSE #MAIN_ASSET_TABLE#.ZPLAYBACKSTYLE END AS Play_Back_Style,
ZADDITIONALASSETATTRIBUTES.ZSHARECOUNT AS Share_Count,
ZADDITIONALASSETATTRIBUTES.ZVIEWCOUNT AS View_Count,
ZADDITIONALASSETATTRIBUTES.ZPLAYCOUNT AS Play_Count,
CASE #MAIN_ASSET_TABLE#.ZFAVORITE WHEN 1 THEN 'Yes' ELSE 'No' END AS Favourited,

#SHARE_TABLE#.ZSHAREURL AS Shared_URL,
datetime('2001-01-01', #SHARE_TABLE#.ZSTARTDATE || ' seconds') AS Shared_From,
datetime('2001-01-01', #SHARE_TABLE#.ZEXPIRYDATE || ' seconds') AS Shared_Ends,
quote(#SHARE_TABLE#.ZPREVIEWDATA) AS Shared_Thumbnail_BLOB,

CASE #MAIN_ASSET_TABLE#.ZCLOUDLOCALSTATE WHEN 0 THEN 'Local' WHEN 1 THEN 'Remote' END AS File_Local_Cloudstate,
CASE #MAIN_ASSET_TABLE#.ZCLOUDISMYASSET WHEN 0 THEN 'No' WHEN 1 THEN 'Yes' END AS Cloud_File_Is_My_Asset,
#MAIN_ASSET_TABLE#.ZCLOUDISDELETABLE AS Cloud_File_Can_Be_Deleted,
CASE ZGENERICALBUM.ZCLOUDLOCALSTATE WHEN 0 THEN 'Local' WHEN 1 THEN 'Remote' END AS Album_Local_Cloudstate,
CASE #MAIN_ASSET_TABLE#.ZCLOUDPLACEHOLDERKIND WHEN '0' THEN 'High Resolution' WHEN 4 THEN 'Low Resolution' WHEN 5 THEN 'Low Resolution' ELSE #MAIN_ASSET_TABLE#.ZCLOUDPLACEHOLDERKIND END AS Cloud_Placeholder,
CASE #MAIN_ASSET_TABLE#.ZSAVEDASSETTYPE WHEN 6 THEN 'From Cloud' WHEN 3 THEN 'From Device' END AS Saved_Asset_Type,
CASE ZCLOUDMASTERMEDIAMETADATA.Z_OPT WHEN 1 THEN 'Cloud' WHEN 2 THEN 'This Device' WHEN 3 THEN 'Mutated' ELSE ZCLOUDMASTERMEDIAMETADATA.Z_OPT END AS File_Origin,

ZCLOUDSHAREDALBUMINVITATIONRECORD.ZINVITEEFULLNAME AS Invitee_Fullname,
ZCLOUDSHAREDALBUMINVITATIONRECORD.ZINVITEESUBSCRIPTIONDATE AS Invitee_Invited_Date,

ZADDITIONALASSETATTRIBUTES.ZMASTERFINGERPRINT AS Master_Fingerprint,

quote(ZCLOUDMASTERMEDIAMETADATA.ZDATA) AS Cloud_Media_Metadata,

ZMEMORY.ZTITLE AS Memory_Title,
ZMEMORY.ZSUBTITLE AS Memory_Subtitle,
datetime('2001-01-01', ZMEMORY.ZCREATIONDATE || ' seconds') AS Memory_Creation_Timestamp,
datetime('2001-01-01', ZMEMORY.ZLASTVIEWEDDATE || ' seconds') AS Memory_Last_Viewed_Date,

ZMOMENT.ZTITLE AS Moment_Title,
ZMOMENT.ZSUBTITLE AS Moment_Subtitle,
datetime('2001-01-01', ZMOMENT.ZSTARTDATE || ' seconds') AS Moment_Start_Date,
datetime('2001-01-01', ZMOMENT.ZENDDATE || ' seconds') AS Moment_End_Date,
CASE ZMOMENT.ZAPPROXIMATELATITUDE WHEN '-180.0' THEN '-' ELSE ZMOMENT.ZAPPROXIMATELATITUDE END AS Moment_Latitude,
CASE ZMOMENT.ZAPPROXIMATELONGITUDE WHEN '-180.0' THEN '-' ELSE ZMOMENT.ZAPPROXIMATELONGITUDE END AS Moment_Longitude,quote(ZMOMENTLIST.ZREVERSELOCATIONDATA) AS Moment_Location

 FROM 
#MAIN_ASSET_TABLE# 

LEFT JOIN 
#ASSETS_TABLE# ON #ASSETS_TABLE#.#ASSETS_COLUMN# = #MAIN_ASSET_TABLE#.Z_PK 

LEFT JOIN 
ZGENERICALBUM ON ZGENERICALBUM.Z_PK = #ASSETS_TABLE#.#ALBUM_COLUMN# 

LEFT JOIN
ZCLOUDMASTER ON ZCLOUDMASTER.Z_PK = #MAIN_ASSET_TABLE#.ZMASTER

LEFT JOIN
ZCLOUDMASTERMEDIAMETADATA ON ZCLOUDMASTERMEDIAMETADATA.ZCLOUDMASTER = ZCLOUDMASTER.Z_PK

LEFT JOIN 
ZMOMENT ON ZMOMENT.Z_PK = #MAIN_ASSET_TABLE#.ZMOMENT 

LEFT JOIN 
ZMOMENTLIST ON ZMOMENTLIST.Z_PK = ZMOMENT.ZMEGAMOMENTLIST 

LEFT JOIN 
ZCLOUDSHAREDALBUMINVITATIONRECORD ON ZGENERICALBUM.Z_PK = ZCLOUDSHAREDALBUMINVITATIONRECORD.ZALBUM 

LEFT JOIN 
#SHARE_TABLE# ON #SHARE_TABLE#.Z_PK = #MAIN_ASSET_TABLE#.ZMOMENTSHARE 

LEFT JOIN 
ZADDITIONALASSETATTRIBUTES ON ZADDITIONALASSETATTRIBUTES.ZASSET = #MAIN_ASSET_TABLE#.Z_PK 

LEFT JOIN 
ZUNMANAGEDADJUSTMENT ON #MAIN_ASSET_TABLE#.Z_PK = ZUNMANAGEDADJUSTMENT.ZASSETATTRIBUTES 

LEFT JOIN 
ZMEMORY ON ZADDITIONALASSETATTRIBUTES.ZASSET = ZMEMORY.ZKEYASSET 

ORDER BY 
#MAIN_ASSET_TABLE#.ZDATECREATED ASC